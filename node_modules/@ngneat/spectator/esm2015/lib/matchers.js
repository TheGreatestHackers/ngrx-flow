/** Credit: https://github.com/unindented/custom-jquery-matchers/tree/master/packages/custom-jquery-matchers */
// tslint:disable:no-shadowed-variable
import $ from 'jquery';
import { hex2rgb, isHex, trim } from './internals/rgb-to-hex';
import { isHTMLOptionElementArray, isObject } from './types';
import { isRunningInJsDom } from './utils';
const hasProperty = (actual, expected) => {
    return expected === undefined ? actual !== undefined : actual === expected;
};
const ɵ0 = hasProperty;
const containsProperty = (actual, expected) => {
    return expected === undefined ? true : actual.includes(expected);
};
const ɵ1 = containsProperty;
const checkProperty = (el, prop, predicate) => {
    let pass = false;
    let failing = '';
    for (const key of Object.keys(prop)) {
        const actual = $(el).prop(key);
        const addendum = prop[key] !== undefined ? ` with value '${prop[key]}'` : '';
        pass = predicate(actual, prop[key]);
        failing = !pass ? `'${prop}'${addendum}, but had '${actual}'` : '';
    }
    const message = () => `Expected element${pass ? ' not' : ''} to have property ${failing}`;
    return { pass, message };
};
const ɵ2 = checkProperty;
const hasCss = (el, css) => {
    let prop;
    let value;
    const $el = $(el);
    for (prop in css) {
        if (css.hasOwnProperty(prop)) {
            value = css[prop];
            if (isHex(value)) {
                value = hex2rgb(css[prop]);
            }
            if (value === 'auto' && $el.get(0).style[prop] === 'auto') {
                continue;
            }
            if (trim($el.css(prop)) !== trim(value) && trim(el.style[prop]) !== trim(value)) {
                return false;
            }
        }
    }
    return true;
};
const ɵ3 = hasCss;
const hasSameText = (el, expected, exact = false) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = exact ? $(e).text() : $.trim($(e).text());
            pass = exact ? actual === expected[i] : actual.includes(expected[i]);
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = exact ? $(el).text() : $.trim($(el).text());
    if (expected && typeof expected !== 'string') {
        const pass = expected(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text matching '${expected}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = exact && !Array.isArray(expected) ? actual === expected : actual.indexOf(expected) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${expected}', but had '${actual}'`;
    return { pass, message };
};
const ɵ4 = hasSameText;
const comparator = (func) => () => ({
    compare: func
});
const ɵ5 = comparator;
const ɵ6 = (el) => {
    const actual = $(el).length;
    const pass = actual > 0;
    const message = () => `Expected ${el} element${pass ? ' not' : ''} to exist`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').not.toExist();
 */
export const toExist = comparator(ɵ6);
const ɵ7 = (el, expected) => {
    const actual = $(el).length;
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have length ${expected}, but had ${actual}`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveLength(3);
 */
export const toHaveLength = comparator(ɵ7);
const ɵ8 = (el, expected) => {
    const actual = $(el).attr('id');
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have ID '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveId('ID');
 */
export const toHaveId = comparator(ɵ8);
const ɵ9 = (el, expected) => {
    if (expected && Array.isArray(expected)) {
        const actual = $(el).attr('class');
        const expectedClasses = expected.join(' ');
        const pass = $(el).hasClass(expectedClasses);
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${expectedClasses}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).attr('class');
    const pass = $(el).hasClass(expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have class '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveClass('class');
 * expect('.zippy__content').toHaveClass('class a, class b');
 * expect('.zippy__content').toHaveClass(['class a, class b']);
 */
export const toHaveClass = comparator(ɵ9);
const ɵ10 = (el, attr, val) => {
    if (isObject(attr)) {
        let pass = false;
        let failing;
        for (const key of Object.keys(attr)) {
            const actual = $(el).attr(key);
            const addendum = attr[key] !== undefined ? ` with value '${attr[key]}'` : '';
            pass = hasProperty(actual, attr[key]);
            failing = !pass ? `'${attr}'${addendum}, but had '${actual}'` : '';
        }
        const message = () => `Expected element${pass ? ' not' : ''} to have attribute ${failing}`;
        return { pass, message };
    }
    const actual = $(el).attr(attr);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have attribute '${attr}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 * expect(host.query('.zippy')).toHaveAttribute('id', 'zippy');
 */
export const toHaveAttribute = comparator(ɵ10);
const ɵ11 = (el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, hasProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 *  expect(host.query('.checkbox')).toHaveProperty('checked', true);
 *  expect(host.query('.checkbox')).toHaveProperty({checked: true});
 */
export const toHaveProperty = comparator(ɵ11);
const ɵ12 = (el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, containsProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = containsProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
export const toContainProperty = comparator(ɵ12);
const ɵ13 = (el, expected, exact = false) => hasSameText(el, expected, exact);
/**
 *
 * expect('.zippy__content').toHaveText('Content');
 * expect('.zippy__content').toHaveText(['Content A', 'Content B']);
 *
 * expect('.zippy__content').toHaveText((text) => text.includes('..');
 */
export const toHaveText = comparator(ɵ13);
const ɵ14 = (el, expected) => hasSameText(el, expected, true);
export const toHaveExactText = comparator(ɵ14);
export const toContainText = toHaveText;
const ɵ15 = (el, expected) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = $(e).val();
            pass = actual === expected[i];
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have value '${expected}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveValue('value');
 * expect('.zippy__content').toHaveValue(['value a', 'value b']);
 */
export const toHaveValue = comparator(ɵ15);
export const toContainValue = toHaveValue;
const ɵ16 = (el, expected) => {
    const pass = hasCss(el, expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have CSS ${JSON.stringify(expected)}`;
    return { pass, message };
};
/**
 *
 *  expect(host.element).toHaveStyle({
 *    backgroundColor: 'rgba(0, 0, 0, 0.1)'
 *  });
 */
export const toHaveStyle = comparator(ɵ16);
const ɵ17 = (el, { data, val }) => {
    const actual = $(el).data(data);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have data '${data}'${addendum}, but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('.zippy__content').toHaveData({data: 'role', val: 'admin'});
 */
export const toHaveData = comparator(ɵ17);
const ɵ18 = el => {
    const pass = $(el).is(':checked');
    const message = () => `Expected element${pass ? ' not' : ''} to be checked`;
    return { pass, message };
};
/**
 *
 * expect('.checkbox').toBeChecked();
 */
export const toBeChecked = comparator(ɵ18);
const ɵ19 = el => {
    const pass = $(el).is(':disabled');
    const message = () => `Expected element${pass ? ' not' : ''} to be disabled`;
    return { pass, message };
};
/**
 *
 * expect('.checkbox').toBeDisabled();
 */
export const toBeDisabled = comparator(ɵ19);
const ɵ20 = el => {
    const pass = $(el).is(':empty');
    const message = () => `Expected element${pass ? ' not' : ''} to be empty`;
    return { pass, message };
};
/**
 * An empty element is an element without child elements or text.
 *
 * expect('div').toBeEmpty();
 */
export const toBeEmpty = comparator(ɵ20);
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0 (check not applied in jest)
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 */
function isHidden(elOrSelector) {
    let el = $(elOrSelector)[0];
    if (!el) {
        return true;
    }
    const hiddenWhen = [
        el => !(el.offsetWidth || el.offsetHeight || el.getClientRects().length),
        el => el.style.display === 'none',
        el => el.style.visibility === 'hidden',
        el => el.type === 'hidden',
        el => el.hasAttribute('hidden')
    ];
    if (isRunningInJsDom()) {
        // When running in JSDOM (Jest), offset-properties and client rects are always reported as 0
        // - hence, let's take a more "naive" approach here. (https://github.com/jsdom/jsdom/issues/135)
        hiddenWhen.shift();
    }
    while (el) {
        if (el === document) {
            break;
        }
        if (hiddenWhen.some(rule => rule(el))) {
            return true;
        }
        el = el.parentNode;
    }
    return false;
}
const ɵ21 = el => {
    const pass = isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be hidden`;
    return { pass, message };
};
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeHidden();
 *
 */
export const toBeHidden = comparator(ɵ21);
const ɵ22 = el => {
    const pass = $(el).is(':selected');
    const message = () => `Expected element${pass ? ' not' : ''} to be selected`;
    return { pass, message };
};
/**
 * The :selected selector selects option elements that are pre-selected.
 *
 * expect('div').toBeSelected();
 *
 */
export const toBeSelected = comparator(ɵ22);
const ɵ23 = el => {
    const pass = !isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be visible`;
    return { pass, message };
};
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeVisible();
 *
 */
export const toBeVisible = comparator(ɵ23);
const ɵ24 = el => {
    const element = $(el).get(0);
    const pass = element === element.ownerDocument.activeElement;
    const message = () => `Expected element${pass ? ' not' : ''} to be focused`;
    return { pass, message };
};
/**
 * The :focus selector selects the element that currently has focus.
 *
 * expect('input').toBeFocused();
 */
export const toBeFocused = comparator(ɵ24);
const ɵ25 = (el, expected) => {
    const actual = $(el).filter(expected).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to be matched by '${expected}'`;
    return { pass, message };
};
/**
 * Check to see if the set of matched elements matches the given selector
 * returns true if the dom contains the element
 *
 * expect('div').toBeMatchedBy('.js-something')
 */
export const toBeMatchedBy = comparator(ɵ25);
const ɵ26 = (el, selector) => {
    const actual = $(el).find(selector).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to contain child '${selector}'`;
    return { pass, message };
};
/**
 *
 * expect('div').toHaveDescendant('.child')
 */
export const toHaveDescendant = comparator(ɵ26);
const ɵ27 = (el, { selector, text }) => {
    const actual = $.trim($(el)
        .find(selector)
        .text());
    if (text && $.isFunction(text.test)) {
        const pass = text.test(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text matching '${text}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = actual.indexOf(text) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text '${text}', but had '${actual}'`;
    return { pass, message };
};
/**
 *
 * expect('div').toHaveDescendantWithText({selector: '.child', text: 'text'})
 */
export const toHaveDescendantWithText = comparator(ɵ27);
const ɵ28 = (el, expected) => {
    if (expected instanceof HTMLOptionElement) {
        const actual = $(el).find(':selected');
        const pass = actual.is($(expected));
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expected.outerHTML}]' but had '[${actual[0].outerHTML}]'`;
        return { pass, message };
    }
    if (isHTMLOptionElementArray(expected)) {
        const actual = $(el).find(':selected');
        const pass = actual.length === expected.length && actual.toArray().every((_, index) => $(actual[index]).is(expected[index]));
        const expectedOptionsString = $(expected)
            .get()
            .map(option => option.outerHTML)
            .join(',');
        const actualOptionsString = actual
            .get()
            .map(option => option.outerHTML)
            .join(',');
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actualOptionsString}]'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = JSON.stringify([...actual]) === JSON.stringify([...expected]);
    const expectedOptionsString = Array.isArray(expected)
        ? expected.reduce((acc, val, i) => acc + `${i === expected.length ? '' : ','}${val}`)
        : expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actual}]'`;
    return { pass, message };
};
export const toHaveSelectedOptions = comparator(ɵ28);
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8, ɵ9, ɵ10, ɵ11, ɵ12, ɵ13, ɵ14, ɵ15, ɵ16, ɵ17, ɵ18, ɵ19, ɵ20, ɵ21, ɵ22, ɵ23, ɵ24, ɵ25, ɵ26, ɵ27, ɵ28 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0Y2hlcnMuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL25ldGFuZWxiYXNhbC93d3cvc3BlY3RhdG9yL3Byb2plY3RzL3NwZWN0YXRvci9zcmMvIiwic291cmNlcyI6WyJsaWIvbWF0Y2hlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsK0dBQStHO0FBQy9HLHNDQUFzQztBQUV0QyxPQUFPLENBQUMsTUFBTSxRQUFRLENBQUM7QUFFdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDOUQsT0FBTyxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUM3RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFlM0MsTUFBTSxXQUFXLEdBQUcsQ0FBQyxNQUFlLEVBQUUsUUFBaUIsRUFBVyxFQUFFO0lBQ2xFLE9BQU8sUUFBUSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLFFBQVEsQ0FBQztBQUM3RSxDQUFDLENBQUM7O0FBRUYsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLE1BQWMsRUFBRSxRQUFpQixFQUFXLEVBQUU7SUFDdEUsT0FBTyxRQUFRLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBa0IsQ0FBQyxDQUFDO0FBQzdFLENBQUMsQ0FBQzs7QUFFRixNQUFNLGFBQWEsR0FBRyxDQUNwQixFQUFlLEVBQ2YsSUFBWSxFQUNaLFNBQXdDLEVBQ0UsRUFBRTtJQUM1QyxJQUFJLElBQUksR0FBRyxLQUFLLENBQUM7SUFDakIsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBRWpCLEtBQUssTUFBTSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNuQyxNQUFNLE1B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LE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDM0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDO0lBRTNFLE1BQU0scUJBQXFCLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7UUFDbkQsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFXLEVBQUUsR0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBQ3JHLENBQUMsQ0FBQyxRQUFRLENBQUM7SUFDYixNQUFNLE9BQU8sR0FBRyxHQUFHLEVBQUUsQ0FBQyxtQkFBbUIsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsc0JBQXNCLHFCQUFxQixnQkFBZ0IsTUFBTSxJQUFJLENBQUM7SUFFakksT0FBTyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQztBQUMzQixDQUFDO0FBMUNELE1BQU0sQ0FBQyxNQUFNLHFCQUFxQixHQUFHLFVBQVUsS0EwQzdDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiogQ3JlZGl0OiBodHRwczovL2dpdGh1Yi5jb20vdW5pbmRlbnRlZC9jdXN0b20tanF1ZXJ5LW1hdGNoZXJzL3RyZWUvbWFzdGVyL3BhY2thZ2VzL2N1c3RvbS1qcXVlcnktbWF0Y2hlcnMgKi9cbi8vIHRzbGludDpkaXNhYmxlOm5vLXNoYWRvd2VkLXZhcmlhYmxlXG5cbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5cbmltcG9ydCB7IGhleDJyZ2IsIGlzSGV4LCB0cmltIH0gZnJvbSAnLi9pbnRlcm5hbHMvcmdiLXRvLWhleCc7XG5pbXBvcnQgeyBpc0hUTUxPcHRpb25FbGVtZW50QXJyYXksIGlzT2JqZWN0IH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBpc1J1bm5pbmdJbkpzRG9tIH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tTWF0Y2hlckZhY3Rvcnkge1xuICAoKTogQ3VzdG9tTWF0Y2hlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21NYXRjaGVyIHtcbiAgY29tcGFyZTxUPihhY3R1YWw6IFQsIGV4cGVjdGVkOiBULCAuLi5hcmdzOiBhbnlbXSk6IEN1c3RvbU1hdGNoZXJSZXN1bHQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tTWF0Y2hlclJlc3VsdCB7XG4gIHBhc3M6IGJvb2xlYW47XG4gIG1lc3NhZ2U/OiBzdHJpbmc7XG59XG5cbmNvbnN0IGhhc1Byb3BlcnR5ID0gKGFjdHVhbDogdW5rbm93biwgZXhwZWN0ZWQ6IHVua25vd24pOiBib29sZWFuID0+IHtcbiAgcmV0dXJuIGV4cGVjdGVkID09PSB1bmRlZmluZWQgPyBhY3R1YWwgIT09IHVuZGVmaW5lZCA6IGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG59O1xuXG5jb25zdCBjb250YWluc1Byb3BlcnR5ID0gKGFjdHVhbDogc3RyaW5nLCBleHBlY3RlZDogdW5rbm93bik6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gZXhwZWN0ZWQgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhY3R1YWwuaW5jbHVkZXMoZXhwZWN0ZWQgYXMgc3RyaW5nKTtcbn07XG5cbmNvbnN0IGNoZWNrUHJvcGVydHkgPSAoXG4gIGVsOiBIVE1MRWxlbWVudCxcbiAgcHJvcDogb2JqZWN0LFxuICBwcmVkaWNhdGU6IChhY3R1YWwsIGV4cGVjdGVkKSA9PiBib29sZWFuXG4pOiB7IHBhc3M6IGJvb2xlYW47IG1lc3NhZ2U6ICgpID0+IHN0cmluZyB9ID0+IHtcbiAgbGV0IHBhc3MgPSBmYWxzZTtcbiAgbGV0IGZhaWxpbmcgPSAnJztcblxuICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhwcm9wKSkge1xuICAgIGNvbnN0IGFjdHVhbCA9ICQoZWwpLnByb3Aoa2V5KTtcbiAgICBjb25zdCBhZGRlbmR1bSA9IHByb3Bba2V5XSAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke3Byb3Bba2V5XX0nYCA6ICcnO1xuXG4gICAgcGFzcyA9IHByZWRpY2F0ZShhY3R1YWwsIHByb3Bba2V5XSk7XG4gICAgZmFpbGluZyA9ICFwYXNzID8gYCcke3Byb3B9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYCA6ICcnO1xuICB9XG5cbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgcHJvcGVydHkgJHtmYWlsaW5nfWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufTtcblxuY29uc3QgaGFzQ3NzID0gKGVsOiBIVE1MRWxlbWVudCwgY3NzOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9KSA9PiB7XG4gIGxldCBwcm9wO1xuICBsZXQgdmFsdWU7XG4gIGNvbnN0ICRlbCA9ICQoZWwpO1xuICBmb3IgKHByb3AgaW4gY3NzKSB7XG4gICAgaWYgKGNzcy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgdmFsdWUgPSBjc3NbcHJvcF07XG5cbiAgICAgIGlmIChpc0hleCh2YWx1ZSkpIHtcbiAgICAgICAgdmFsdWUgPSBoZXgycmdiKGNzc1twcm9wXSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh2YWx1ZSA9PT0gJ2F1dG8nICYmICRlbC5nZXQoMCkuc3R5bGVbcHJvcF0gPT09ICdhdXRvJykge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRyaW0oJGVsLmNzcyhwcm9wKSkgIT09IHRyaW0odmFsdWUpICYmIHRyaW0oZWwuc3R5bGVbcHJvcF0pICE9PSB0cmltKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5jb25zdCBoYXNTYW1lVGV4dCA9IChlbDogSFRNTEVsZW1lbnQsIGV4cGVjdGVkOiBzdHJpbmcgfCBzdHJpbmdbXSB8ICgoczogc3RyaW5nKSA9PiBib29sZWFuKSwgZXhhY3QgPSBmYWxzZSkgPT4ge1xuICBpZiAoZXhwZWN0ZWQgJiYgQXJyYXkuaXNBcnJheShleHBlY3RlZCkpIHtcbiAgICBsZXQgYWN0dWFsOiBzdHJpbmc7XG4gICAgbGV0IHBhc3MgPSBmYWxzZTtcbiAgICBsZXQgZmFpbGluZzogc3RyaW5nO1xuXG4gICAgJChlbCkuZWFjaCgoaSwgZSkgPT4ge1xuICAgICAgYWN0dWFsID0gZXhhY3QgPyAkKGUpLnRleHQoKSA6ICQudHJpbSgkKGUpLnRleHQoKSk7XG4gICAgICBwYXNzID0gZXhhY3QgPyBhY3R1YWwgPT09IGV4cGVjdGVkW2ldIDogYWN0dWFsLmluY2x1ZGVzKGV4cGVjdGVkW2ldKTtcbiAgICAgIGlmICghcGFzcykge1xuICAgICAgICBmYWlsaW5nID0gZXhwZWN0ZWRbaV07XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgJHtleGFjdCA/ICdleGFjdCcgOiAnJ30gdGV4dCAnJHtmYWlsaW5nfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gZXhhY3QgPyAkKGVsKS50ZXh0KCkgOiAkLnRyaW0oJChlbCkudGV4dCgpKTtcblxuICBpZiAoZXhwZWN0ZWQgJiYgdHlwZW9mIGV4cGVjdGVkICE9PSAnc3RyaW5nJykge1xuICAgIGNvbnN0IHBhc3MgPSBleHBlY3RlZChhY3R1YWwpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PlxuICAgICAgYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSAke2V4YWN0ID8gJ2V4YWN0JyA6ICcnfSB0ZXh0IG1hdGNoaW5nICcke2V4cGVjdGVkfScsYCArIGAgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBwYXNzID0gZXhhY3QgJiYgIUFycmF5LmlzQXJyYXkoZXhwZWN0ZWQpID8gYWN0dWFsID09PSBleHBlY3RlZCA6IGFjdHVhbC5pbmRleE9mKGV4cGVjdGVkKSAhPT0gLTE7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlICR7ZXhhY3QgPyAnZXhhY3QnIDogJyd9IHRleHQgJyR7ZXhwZWN0ZWR9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufTtcblxuY29uc3QgY29tcGFyYXRvciA9IChmdW5jKTogQ3VzdG9tTWF0Y2hlckZhY3RvcnkgPT4gKCkgPT4gKHtcbiAgY29tcGFyZTogZnVuY1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50Jykubm90LnRvRXhpc3QoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvRXhpc3QgPSBjb21wYXJhdG9yKChlbDogc3RyaW5nIHwgRWxlbWVudCkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5sZW5ndGg7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPiAwO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkICR7ZWx9IGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gZXhpc3RgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUxlbmd0aCgzKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZUxlbmd0aCA9IGNvbXBhcmF0b3IoKGVsOiBzdHJpbmcsIGV4cGVjdGVkOiBudW1iZXIpID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJChlbCkubGVuZ3RoO1xuICBjb25zdCBwYXNzID0gYWN0dWFsID09PSBleHBlY3RlZDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgbGVuZ3RoICR7ZXhwZWN0ZWR9LCBidXQgaGFkICR7YWN0dWFsfWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlSWQoJ0lEJyk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVJZCA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5hdHRyKCdpZCcpO1xuICBjb25zdCBwYXNzID0gYWN0dWFsID09PSBleHBlY3RlZDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgSUQgJyR7ZXhwZWN0ZWR9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlQ2xhc3MoJ2NsYXNzJyk7XG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUNsYXNzKCdjbGFzcyBhLCBjbGFzcyBiJyk7XG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUNsYXNzKFsnY2xhc3MgYSwgY2xhc3MgYiddKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZUNsYXNzID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkOiBzdHJpbmcgfCBzdHJpbmdbXSkgPT4ge1xuICBpZiAoZXhwZWN0ZWQgJiYgQXJyYXkuaXNBcnJheShleHBlY3RlZCkpIHtcbiAgICBjb25zdCBhY3R1YWw6IHN0cmluZyA9ICQoZWwpLmF0dHIoJ2NsYXNzJyk7XG4gICAgY29uc3QgZXhwZWN0ZWRDbGFzc2VzID0gZXhwZWN0ZWQuam9pbignICcpO1xuICAgIGNvbnN0IHBhc3MgPSAkKGVsKS5oYXNDbGFzcyhleHBlY3RlZENsYXNzZXMpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIHZhbHVlICcke2V4cGVjdGVkQ2xhc3Nlc30nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmF0dHIoJ2NsYXNzJyk7XG4gIGNvbnN0IHBhc3MgPSAkKGVsKS5oYXNDbGFzcyhleHBlY3RlZCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGNsYXNzICcke2V4cGVjdGVkfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIGV4cGVjdChob3N0LnF1ZXJ5KCcuemlwcHknKSkudG9IYXZlQXR0cmlidXRlKCdpZCcsICd6aXBweScpO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlQXR0cmlidXRlID0gY29tcGFyYXRvcigoZWwsIGF0dHI6IHN0cmluZyB8IG9iamVjdCwgdmFsKSA9PiB7XG4gIGlmIChpc09iamVjdChhdHRyKSkge1xuICAgIGxldCBwYXNzID0gZmFsc2U7XG4gICAgbGV0IGZhaWxpbmc6IHN0cmluZztcblxuICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGF0dHIpKSB7XG4gICAgICBjb25zdCBhY3R1YWwgPSAkKGVsKS5hdHRyKGtleSk7XG4gICAgICBjb25zdCBhZGRlbmR1bSA9IGF0dHJba2V5XSAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke2F0dHJba2V5XX0nYCA6ICcnO1xuICAgICAgcGFzcyA9IGhhc1Byb3BlcnR5KGFjdHVhbCwgYXR0cltrZXldKTtcbiAgICAgIGZhaWxpbmcgPSAhcGFzcyA/IGAnJHthdHRyfScke2FkZGVuZHVtfSwgYnV0IGhhZCAnJHthY3R1YWx9J2AgOiAnJztcbiAgICB9XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgYXR0cmlidXRlICR7ZmFpbGluZ31gO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkuYXR0cihhdHRyKTtcbiAgY29uc3QgYWRkZW5kdW0gPSB2YWwgIT09IHVuZGVmaW5lZCA/IGAgd2l0aCB2YWx1ZSAnJHt2YWx9J2AgOiAnJztcbiAgY29uc3QgcGFzcyA9IGhhc1Byb3BlcnR5KGFjdHVhbCwgdmFsKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgYXR0cmlidXRlICcke2F0dHJ9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiAgZXhwZWN0KGhvc3QucXVlcnkoJy5jaGVja2JveCcpKS50b0hhdmVQcm9wZXJ0eSgnY2hlY2tlZCcsIHRydWUpO1xuICogIGV4cGVjdChob3N0LnF1ZXJ5KCcuY2hlY2tib3gnKSkudG9IYXZlUHJvcGVydHkoe2NoZWNrZWQ6IHRydWV9KTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZVByb3BlcnR5ID0gY29tcGFyYXRvcigoZWwsIHByb3AsIHZhbCkgPT4ge1xuICBpZiAoaXNPYmplY3QocHJvcCkpIHtcbiAgICByZXR1cm4gY2hlY2tQcm9wZXJ0eShlbCwgcHJvcCwgaGFzUHJvcGVydHkpO1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkucHJvcChwcm9wKTtcbiAgY29uc3QgYWRkZW5kdW0gPSB2YWwgIT09IHVuZGVmaW5lZCA/IGAgd2l0aCB2YWx1ZSAnJHt2YWx9J2AgOiAnJztcbiAgY29uc3QgcGFzcyA9IGhhc1Byb3BlcnR5KGFjdHVhbCwgdmFsKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgcHJvcGVydHkgJyR7cHJvcH0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG5leHBvcnQgY29uc3QgdG9Db250YWluUHJvcGVydHkgPSBjb21wYXJhdG9yKChlbCwgcHJvcCwgdmFsKSA9PiB7XG4gIGlmIChpc09iamVjdChwcm9wKSkge1xuICAgIHJldHVybiBjaGVja1Byb3BlcnR5KGVsLCBwcm9wLCBjb250YWluc1Byb3BlcnR5KTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLnByb3AocHJvcCk7XG4gIGNvbnN0IGFkZGVuZHVtID0gdmFsICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7dmFsfSdgIDogJyc7XG4gIGNvbnN0IHBhc3MgPSBjb250YWluc1Byb3BlcnR5KGFjdHVhbCwgdmFsKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgcHJvcGVydHkgJyR7cHJvcH0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZVRleHQoJ0NvbnRlbnQnKTtcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlVGV4dChbJ0NvbnRlbnQgQScsICdDb250ZW50IEInXSk7XG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVUZXh0KCh0ZXh0KSA9PiB0ZXh0LmluY2x1ZGVzKCcuLicpO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlVGV4dCA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCwgZXhhY3QgPSBmYWxzZSkgPT4gaGFzU2FtZVRleHQoZWwsIGV4cGVjdGVkLCBleGFjdCkpO1xuXG5leHBvcnQgY29uc3QgdG9IYXZlRXhhY3RUZXh0ID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkKSA9PiBoYXNTYW1lVGV4dChlbCwgZXhwZWN0ZWQsIHRydWUpKTtcblxuZXhwb3J0IGNvbnN0IHRvQ29udGFpblRleHQgPSB0b0hhdmVUZXh0O1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZVZhbHVlKCd2YWx1ZScpO1xuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVWYWx1ZShbJ3ZhbHVlIGEnLCAndmFsdWUgYiddKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZVZhbHVlID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkKSA9PiB7XG4gIGlmIChleHBlY3RlZCAmJiBBcnJheS5pc0FycmF5KGV4cGVjdGVkKSkge1xuICAgIGxldCBhY3R1YWw6IHN0cmluZztcbiAgICBsZXQgcGFzcyA9IGZhbHNlO1xuICAgIGxldCBmYWlsaW5nOiBzdHJpbmc7XG5cbiAgICAkKGVsKS5lYWNoKChpLCBlKSA9PiB7XG4gICAgICBhY3R1YWwgPSAkKGUpLnZhbCgpO1xuICAgICAgcGFzcyA9IGFjdHVhbCA9PT0gZXhwZWN0ZWRbaV07XG4gICAgICBpZiAoIXBhc3MpIHtcbiAgICAgICAgZmFpbGluZyA9IGV4cGVjdGVkW2ldO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIHZhbHVlICcke2ZhaWxpbmd9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS52YWwoKTtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIHZhbHVlICcke2V4cGVjdGVkfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG5leHBvcnQgY29uc3QgdG9Db250YWluVmFsdWUgPSB0b0hhdmVWYWx1ZTtcblxuLyoqXG4gKlxuICogIGV4cGVjdChob3N0LmVsZW1lbnQpLnRvSGF2ZVN0eWxlKHtcbiAqICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMC4xKSdcbiAqICB9KTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZVN0eWxlID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkKSA9PiB7XG4gIGNvbnN0IHBhc3MgPSBoYXNDc3MoZWwsIGV4cGVjdGVkKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgQ1NTICR7SlNPTi5zdHJpbmdpZnkoZXhwZWN0ZWQpfWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlRGF0YSh7ZGF0YTogJ3JvbGUnLCB2YWw6ICdhZG1pbid9KTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZURhdGEgPSBjb21wYXJhdG9yKChlbCwgeyBkYXRhLCB2YWwgfSkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5kYXRhKGRhdGEpO1xuICBjb25zdCBhZGRlbmR1bSA9IHZhbCAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke3ZhbH0nYCA6ICcnO1xuICBjb25zdCBwYXNzID0gaGFzUHJvcGVydHkoYWN0dWFsLCB2YWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBkYXRhICcke2RhdGF9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuY2hlY2tib3gnKS50b0JlQ2hlY2tlZCgpO1xuICovXG5leHBvcnQgY29uc3QgdG9CZUNoZWNrZWQgPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmlzKCc6Y2hlY2tlZCcpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgY2hlY2tlZGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLmNoZWNrYm94JykudG9CZURpc2FibGVkKCk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlRGlzYWJsZWQgPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmlzKCc6ZGlzYWJsZWQnKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGJlIGRpc2FibGVkYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBBbiBlbXB0eSBlbGVtZW50IGlzIGFuIGVsZW1lbnQgd2l0aG91dCBjaGlsZCBlbGVtZW50cyBvciB0ZXh0LlxuICpcbiAqIGV4cGVjdCgnZGl2JykudG9CZUVtcHR5KCk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlRW1wdHkgPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmlzKCc6ZW1wdHknKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGJlIGVtcHR5YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBIaWRkZW4gZWxlbWVudHMgYXJlIGVsZW1lbnRzIHRoYXQgaGF2ZTpcbiAqIDEuIERpc3BsYXkgcHJvcGVydHkgc2V0IHRvIFwibm9uZVwiXG4gKiAyLiBXaWR0aCBhbmQgaGVpZ2h0IHNldCB0byAwIChjaGVjayBub3QgYXBwbGllZCBpbiBqZXN0KVxuICogMy4gQSBoaWRkZW4gcGFyZW50IGVsZW1lbnQgKHRoaXMgYWxzbyBoaWRlcyBjaGlsZCBlbGVtZW50cylcbiAqIDQuIFR5cGUgZXF1YWwgdG8gXCJoaWRkZW5cIiAob25seSBmb3IgZm9ybSBlbGVtZW50cylcbiAqIDUuIEEgXCJoaWRkZW5cIiBhdHRyaWJ1dGVcbiAqL1xuZnVuY3Rpb24gaXNIaWRkZW4oZWxPclNlbGVjdG9yOiBIVE1MRWxlbWVudCB8IHN0cmluZyk6IGJvb2xlYW4ge1xuICBsZXQgZWwgPSAkKGVsT3JTZWxlY3RvcilbMF07XG5cbiAgaWYgKCFlbCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY29uc3QgaGlkZGVuV2hlbiA9IFtcbiAgICBlbCA9PiAhKGVsLm9mZnNldFdpZHRoIHx8IGVsLm9mZnNldEhlaWdodCB8fCBlbC5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCksXG4gICAgZWwgPT4gZWwuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnLFxuICAgIGVsID0+IGVsLnN0eWxlLnZpc2liaWxpdHkgPT09ICdoaWRkZW4nLFxuICAgIGVsID0+IGVsLnR5cGUgPT09ICdoaWRkZW4nLFxuICAgIGVsID0+IGVsLmhhc0F0dHJpYnV0ZSgnaGlkZGVuJylcbiAgXTtcblxuICBpZiAoaXNSdW5uaW5nSW5Kc0RvbSgpKSB7XG4gICAgLy8gV2hlbiBydW5uaW5nIGluIEpTRE9NIChKZXN0KSwgb2Zmc2V0LXByb3BlcnRpZXMgYW5kIGNsaWVudCByZWN0cyBhcmUgYWx3YXlzIHJlcG9ydGVkIGFzIDBcbiAgICAvLyAtIGhlbmNlLCBsZXQncyB0YWtlIGEgbW9yZSBcIm5haXZlXCIgYXBwcm9hY2ggaGVyZS4gKGh0dHBzOi8vZ2l0aHViLmNvbS9qc2RvbS9qc2RvbS9pc3N1ZXMvMTM1KVxuICAgIGhpZGRlbldoZW4uc2hpZnQoKTtcbiAgfVxuXG4gIHdoaWxlIChlbCkge1xuICAgIGlmIChlbCA9PT0gZG9jdW1lbnQpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChoaWRkZW5XaGVuLnNvbWUocnVsZSA9PiBydWxlKGVsKSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBIaWRkZW4gZWxlbWVudHMgYXJlIGVsZW1lbnRzIHRoYXQgaGF2ZTpcbiAqIDEuIERpc3BsYXkgcHJvcGVydHkgc2V0IHRvIFwibm9uZVwiXG4gKiAyLiBXaWR0aCBhbmQgaGVpZ2h0IHNldCB0byAwXG4gKiAzLiBBIGhpZGRlbiBwYXJlbnQgZWxlbWVudCAodGhpcyBhbHNvIGhpZGVzIGNoaWxkIGVsZW1lbnRzKVxuICogNC4gVHlwZSBlcXVhbCB0byBcImhpZGRlblwiIChvbmx5IGZvciBmb3JtIGVsZW1lbnRzKVxuICogNS4gQSBcImhpZGRlblwiIGF0dHJpYnV0ZVxuICpcbiAqIGV4cGVjdCgnZGl2JykudG9CZUhpZGRlbigpO1xuICpcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVIaWRkZW4gPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgcGFzcyA9IGlzSGlkZGVuKGVsKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGJlIGhpZGRlbmA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogVGhlIDpzZWxlY3RlZCBzZWxlY3RvciBzZWxlY3RzIG9wdGlvbiBlbGVtZW50cyB0aGF0IGFyZSBwcmUtc2VsZWN0ZWQuXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlU2VsZWN0ZWQoKTtcbiAqXG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlU2VsZWN0ZWQgPSBjb21wYXJhdG9yKGVsID0+IHtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmlzKCc6c2VsZWN0ZWQnKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGJlIHNlbGVjdGVkYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBIaWRkZW4gZWxlbWVudHMgYXJlIGVsZW1lbnRzIHRoYXQgaGF2ZTpcbiAqIDEuIERpc3BsYXkgcHJvcGVydHkgc2V0IHRvIFwibm9uZVwiXG4gKiAyLiBXaWR0aCBhbmQgaGVpZ2h0IHNldCB0byAwXG4gKiAzLiBBIGhpZGRlbiBwYXJlbnQgZWxlbWVudCAodGhpcyBhbHNvIGhpZGVzIGNoaWxkIGVsZW1lbnRzKVxuICogNC4gVHlwZSBlcXVhbCB0byBcImhpZGRlblwiIChvbmx5IGZvciBmb3JtIGVsZW1lbnRzKVxuICogNS4gQSBcImhpZGRlblwiIGF0dHJpYnV0ZVxuICpcbiAqIGV4cGVjdCgnZGl2JykudG9CZVZpc2libGUoKTtcbiAqXG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlVmlzaWJsZSA9IGNvbXBhcmF0b3IoZWwgPT4ge1xuICBjb25zdCBwYXNzID0gIWlzSGlkZGVuKGVsKTtcblxuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgdmlzaWJsZWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogVGhlIDpmb2N1cyBzZWxlY3RvciBzZWxlY3RzIHRoZSBlbGVtZW50IHRoYXQgY3VycmVudGx5IGhhcyBmb2N1cy5cbiAqXG4gKiBleHBlY3QoJ2lucHV0JykudG9CZUZvY3VzZWQoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVGb2N1c2VkID0gY29tcGFyYXRvcihlbCA9PiB7XG4gIGNvbnN0IGVsZW1lbnQgPSAkKGVsKS5nZXQoMCk7XG4gIGNvbnN0IHBhc3MgPSBlbGVtZW50ID09PSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGJlIGZvY3VzZWRgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIENoZWNrIHRvIHNlZSBpZiB0aGUgc2V0IG9mIG1hdGNoZWQgZWxlbWVudHMgbWF0Y2hlcyB0aGUgZ2l2ZW4gc2VsZWN0b3JcbiAqIHJldHVybnMgdHJ1ZSBpZiB0aGUgZG9tIGNvbnRhaW5zIHRoZSBlbGVtZW50XG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlTWF0Y2hlZEJ5KCcuanMtc29tZXRoaW5nJylcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVNYXRjaGVkQnkgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQpID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJChlbCkuZmlsdGVyKGV4cGVjdGVkKS5sZW5ndGg7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPiAwO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgbWF0Y2hlZCBieSAnJHtleHBlY3RlZH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0hhdmVEZXNjZW5kYW50KCcuY2hpbGQnKVxuICovXG5leHBvcnQgY29uc3QgdG9IYXZlRGVzY2VuZGFudCA9IGNvbXBhcmF0b3IoKGVsLCBzZWxlY3RvcikgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5maW5kKHNlbGVjdG9yKS5sZW5ndGg7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPiAwO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gY29udGFpbiBjaGlsZCAnJHtzZWxlY3Rvcn0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0hhdmVEZXNjZW5kYW50V2l0aFRleHQoe3NlbGVjdG9yOiAnLmNoaWxkJywgdGV4dDogJ3RleHQnfSlcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZURlc2NlbmRhbnRXaXRoVGV4dCA9IGNvbXBhcmF0b3IoKGVsLCB7IHNlbGVjdG9yLCB0ZXh0IH0pID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJC50cmltKFxuICAgICQoZWwpXG4gICAgICAuZmluZChzZWxlY3RvcilcbiAgICAgIC50ZXh0KClcbiAgKTtcbiAgaWYgKHRleHQgJiYgJC5pc0Z1bmN0aW9uKHRleHQudGVzdCkpIHtcbiAgICBjb25zdCBwYXNzID0gdGV4dC50ZXN0KGFjdHVhbCk7XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGRlc2NlbmRhbnQgJyR7c2VsZWN0b3J9JyB3aXRoIHRleHQgbWF0Y2hpbmcgJyR7dGV4dH0nLGAgKyBgIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwuaW5kZXhPZih0ZXh0KSAhPT0gLTE7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGRlc2NlbmRhbnQgJyR7c2VsZWN0b3J9JyB3aXRoIHRleHQgJyR7dGV4dH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuZXhwb3J0IGNvbnN0IHRvSGF2ZVNlbGVjdGVkT3B0aW9ucyA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBpZiAoZXhwZWN0ZWQgaW5zdGFuY2VvZiBIVE1MT3B0aW9uRWxlbWVudCkge1xuICAgIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmZpbmQoJzpzZWxlY3RlZCcpO1xuXG4gICAgY29uc3QgcGFzcyA9IGFjdHVhbC5pcygkKGV4cGVjdGVkKSk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT5cbiAgICAgIGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgb3B0aW9ucyAnWyR7ZXhwZWN0ZWQub3V0ZXJIVE1MfV0nIGJ1dCBoYWQgJ1ske2FjdHVhbFswXS5vdXRlckhUTUx9XSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgaWYgKGlzSFRNTE9wdGlvbkVsZW1lbnRBcnJheShleHBlY3RlZCkpIHtcbiAgICBjb25zdCBhY3R1YWwgPSAkKGVsKS5maW5kKCc6c2VsZWN0ZWQnKTtcblxuICAgIGNvbnN0IHBhc3MgPSBhY3R1YWwubGVuZ3RoID09PSBleHBlY3RlZC5sZW5ndGggJiYgYWN0dWFsLnRvQXJyYXkoKS5ldmVyeSgoXywgaW5kZXgpID0+ICQoYWN0dWFsW2luZGV4XSkuaXMoZXhwZWN0ZWRbaW5kZXhdKSk7XG5cbiAgICBjb25zdCBleHBlY3RlZE9wdGlvbnNTdHJpbmcgPSAkKGV4cGVjdGVkKVxuICAgICAgLmdldCgpXG4gICAgICAubWFwKG9wdGlvbiA9PiBvcHRpb24ub3V0ZXJIVE1MKVxuICAgICAgLmpvaW4oJywnKTtcblxuICAgIGNvbnN0IGFjdHVhbE9wdGlvbnNTdHJpbmcgPSBhY3R1YWxcbiAgICAgIC5nZXQoKVxuICAgICAgLm1hcChvcHRpb24gPT4gb3B0aW9uLm91dGVySFRNTClcbiAgICAgIC5qb2luKCcsJyk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT5cbiAgICAgIGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgb3B0aW9ucyAnWyR7ZXhwZWN0ZWRPcHRpb25zU3RyaW5nfV0nIGJ1dCBoYWQgJ1ske2FjdHVhbE9wdGlvbnNTdHJpbmd9XSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkudmFsKCk7XG4gIGNvbnN0IHBhc3MgPSBKU09OLnN0cmluZ2lmeShbLi4uYWN0dWFsXSkgPT09IEpTT04uc3RyaW5naWZ5KFsuLi5leHBlY3RlZF0pO1xuXG4gIGNvbnN0IGV4cGVjdGVkT3B0aW9uc1N0cmluZyA9IEFycmF5LmlzQXJyYXkoZXhwZWN0ZWQpXG4gICAgPyBleHBlY3RlZC5yZWR1Y2UoKGFjYzogc3RyaW5nLCB2YWw6IHN0cmluZywgaSkgPT4gYWNjICsgYCR7aSA9PT0gZXhwZWN0ZWQubGVuZ3RoID8gJycgOiAnLCd9JHt2YWx9YClcbiAgICA6IGV4cGVjdGVkO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBvcHRpb25zICdbJHtleHBlY3RlZE9wdGlvbnNTdHJpbmd9XScgYnV0IGhhZCAnWyR7YWN0dWFsfV0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcbiJdfQ==