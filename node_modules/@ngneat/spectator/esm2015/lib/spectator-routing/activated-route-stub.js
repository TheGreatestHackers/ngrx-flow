import { convertToParamMap, ActivatedRoute, ActivatedRouteSnapshot } from '@angular/router';
import { ReplaySubject } from 'rxjs';
import { map } from 'rxjs/operators';
/**
 * @publicApi
 *
 * Utility class for stubbing ActivatedRoute of @angular/router
 */
export class ActivatedRouteStub extends ActivatedRoute {
    constructor(options) {
        super();
        this.testParams = {};
        this.testQueryParams = {};
        this.testData = {};
        this.testFragment = null;
        this.testUrl = [];
        this.testRoot = null;
        this.testParent = null;
        this.testFirstChild = null;
        this.testChildren = null;
        this.paramsSubject = new ReplaySubject(1);
        this.queryParamsSubject = new ReplaySubject(1);
        this.dataSubject = new ReplaySubject(1);
        this.fragmentSubject = new ReplaySubject(1);
        this.urlSubject = new ReplaySubject(1);
        if (options) {
            this.testParams = options.params || {};
            this.testQueryParams = options.queryParams || {};
            this.testData = options.data || {};
            this.testFragment = options.fragment || null;
            this.testUrl = options.url || [];
            this.testRoot = options.root || null;
            this.testParent = options.parent || null;
            this.testFirstChild = options.firstChild || null;
            this.testChildren = options.children || null;
        }
        this.params = this.paramsSubject.asObservable();
        this.queryParams = this.queryParamsSubject.asObservable();
        this.data = this.dataSubject.asObservable();
        this.fragment = this.fragmentSubject.asObservable();
        this.url = this.urlSubject.asObservable();
        this.snapshot = this.buildSnapshot();
        this.triggerNavigation();
    }
    get paramMap() {
        return this.paramsSubject.asObservable().pipe(map(params => convertToParamMap(params)));
    }
    setParams(params) {
        this.testParams = params;
        this.snapshot = this.buildSnapshot();
    }
    setParam(name, value) {
        this.testParams = Object.assign(Object.assign({}, this.testParams), { [name]: value });
        this.snapshot = this.buildSnapshot();
    }
    setQueryParams(queryParams) {
        this.testQueryParams = queryParams;
        this.snapshot = this.buildSnapshot();
    }
    setQueryParam(name, value) {
        this.testQueryParams = Object.assign(Object.assign({}, this.testQueryParams), { [name]: value });
        this.snapshot = this.buildSnapshot();
    }
    setAllData(data) {
        this.testData = data;
        this.snapshot = this.buildSnapshot();
    }
    setData(name, value) {
        this.testData = Object.assign(Object.assign({}, this.testData), { [name]: value });
        this.snapshot = this.buildSnapshot();
    }
    setFragment(fragment) {
        this.testFragment = fragment;
        this.snapshot = this.buildSnapshot();
    }
    setUrl(url) {
        this.testUrl = url;
        this.snapshot = this.buildSnapshot();
    }
    get root() {
        return this.testRoot || this;
    }
    get parent() {
        return this.testParent || null;
    }
    get children() {
        return this.testChildren || [this];
    }
    get firstChild() {
        return this.testFirstChild || null;
    }
    /**
     * Simulates a route navigation by updating the Params, QueryParams and Data observable streams.
     */
    triggerNavigation() {
        this.paramsSubject.next(this.testParams);
        this.queryParamsSubject.next(this.testQueryParams);
        this.dataSubject.next(this.testData);
        this.fragmentSubject.next(this.testFragment);
        this.urlSubject.next(this.testUrl);
    }
    toString() {
        return 'activatedRouteStub';
    }
    buildSnapshot() {
        const snapshot = new ActivatedRouteSnapshot();
        snapshot.params = this.testParams;
        snapshot.queryParams = this.testQueryParams;
        snapshot.data = this.testData;
        snapshot.fragment = this.testFragment;
        snapshot.url = this.testUrl;
        return snapshot;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aXZhdGVkLXJvdXRlLXN0dWIuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL25ldGFuZWxiYXNhbC93d3cvc3BlY3RhdG9yL3Byb2plY3RzL3NwZWN0YXRvci9zcmMvIiwic291cmNlcyI6WyJsaWIvc3BlY3RhdG9yLXJvdXRpbmcvYWN0aXZhdGVkLXJvdXRlLXN0dWIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGNBQWMsRUFBRSxzQkFBc0IsRUFBc0MsTUFBTSxpQkFBaUIsQ0FBQztBQUNoSSxPQUFPLEVBQWMsYUFBYSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUlyQzs7OztHQUlHO0FBQ0gsTUFBTSxPQUFPLGtCQUFtQixTQUFRLGNBQWM7SUFpQnBELFlBQVksT0FBc0I7UUFDaEMsS0FBSyxFQUFFLENBQUM7UUFqQkYsZUFBVSxHQUFXLEVBQUUsQ0FBQztRQUN4QixvQkFBZSxHQUFXLEVBQUUsQ0FBQztRQUM3QixhQUFRLEdBQVMsRUFBRSxDQUFDO1FBQ3BCLGlCQUFZLEdBQWtCLElBQUksQ0FBQztRQUNuQyxZQUFPLEdBQWlCLEVBQUUsQ0FBQztRQUMzQixhQUFRLEdBQThCLElBQUksQ0FBQztRQUMzQyxlQUFVLEdBQThCLElBQUksQ0FBQztRQUM3QyxtQkFBYyxHQUE4QixJQUFJLENBQUM7UUFDakQsaUJBQVksR0FBZ0MsSUFBSSxDQUFDO1FBRXhDLGtCQUFhLEdBQUcsSUFBSSxhQUFhLENBQVMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsdUJBQWtCLEdBQUcsSUFBSSxhQUFhLENBQVMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsZ0JBQVcsR0FBRyxJQUFJLGFBQWEsQ0FBTyxDQUFDLENBQUMsQ0FBQztRQUN6QyxvQkFBZSxHQUFHLElBQUksYUFBYSxDQUFnQixDQUFDLENBQUMsQ0FBQztRQUN0RCxlQUFVLEdBQUcsSUFBSSxhQUFhLENB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QUNyQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFTSxRQUFRO1FBQ2IsT0FBTyxvQkFBb0IsQ0FBQztJQUM5QixDQUFDO0lBRU8sYUFBYTtRQUNuQixNQUFNLFFBQVEsR0FBRyxJQUFJLHNCQUFzQixFQUFFLENBQUM7UUFFOUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ2xDLFFBQVEsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQztRQUM1QyxRQUFRLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDOUIsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsWUFBYSxDQUFDO1FBQ3ZDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUU1QixPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb252ZXJ0VG9QYXJhbU1hcCwgQWN0aXZhdGVkUm91dGUsIEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIERhdGEsIFBhcmFtcywgUGFyYW1NYXAsIFVybFNlZ21lbnQgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgUmVwbGF5U3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBSb3V0ZU9wdGlvbnMgfSBmcm9tICcuL3JvdXRlLW9wdGlvbnMnO1xuXG4vKipcbiAqIEBwdWJsaWNBcGlcbiAqXG4gKiBVdGlsaXR5IGNsYXNzIGZvciBzdHViYmluZyBBY3RpdmF0ZWRSb3V0ZSBvZiBAYW5ndWxhci9yb3V0ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIEFjdGl2YXRlZFJvdXRlU3R1YiBleHRlbmRzIEFjdGl2YXRlZFJvdXRlIHtcbiAgcHJpdmF0ZSB0ZXN0UGFyYW1zOiBQYXJhbXMgPSB7fTtcbiAgcHJpdmF0ZSB0ZXN0UXVlcnlQYXJhbXM6IFBhcmFtcyA9IHt9O1xuICBwcml2YXRlIHRlc3REYXRhOiBEYXRhID0ge307XG4gIHByaXZhdGUgdGVzdEZyYWdtZW50OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSB0ZXN0VXJsOiBVcmxTZWdtZW50W10gPSBbXTtcbiAgcHJpdmF0ZSB0ZXN0Um9vdDogQWN0aXZhdGVkUm91dGVTdHViIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdGVzdFBhcmVudDogQWN0aXZhdGVkUm91dGVTdHViIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdGVzdEZpcnN0Q2hpbGQ6IEFjdGl2YXRlZFJvdXRlU3R1YiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHRlc3RDaGlsZHJlbjogQWN0aXZhdGVkUm91dGVTdHViW10gfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIHJlYWRvbmx5IHBhcmFtc1N1YmplY3QgPSBuZXcgUmVwbGF5U3ViamVjdDxQYXJhbXM+KDEpO1xuICBwcml2YXRlIHJlYWRvbmx5IHF1ZXJ5UGFyYW1zU3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PFBhcmFtcz4oMSk7XG4gIHByaXZhdGUgcmVhZG9ubHkgZGF0YVN1YmplY3QgPSBuZXcgUmVwbGF5U3ViamVjdDxEYXRhPigxKTtcbiAgcHJpdmF0ZSByZWFkb25seSBmcmFnbWVudFN1YmplY3QgPSBuZXcgUmVwbGF5U3ViamVjdDxzdHJpbmcgfCBudWxsPigxKTtcbiAgcHJpdmF0ZSByZWFkb25seSB1cmxTdWJqZWN0ID0gbmV3IFJlcGxheVN1YmplY3Q8VXJsU2VnbWVudFtdPigxKTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zPzogUm91dGVPcHRpb25zKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB0aGlzLnRlc3RQYXJhbXMgPSBvcHRpb25zLnBhcmFtcyB8fCB7fTtcbiAgICAgIHRoaXMudGVzdFF1ZXJ5UGFyYW1zID0gb3B0aW9ucy5xdWVyeVBhcmFtcyB8fCB7fTtcbiAgICAgIHRoaXMudGVzdERhdGEgPSBvcHRpb25zLmRhdGEgfHwge307XG4gICAgICB0aGlzLnRlc3RGcmFnbWVudCA9IG9wdGlvbnMuZnJhZ21lbnQgfHwgbnVsbDtcbiAgICAgIHRoaXMudGVzdFVybCA9IG9wdGlvbnMudXJsIHx8IFtdO1xuICAgICAgdGhpcy50ZXN0Um9vdCA9IG9wdGlvbnMucm9vdCB8fCBudWxsO1xuICAgICAgdGhpcy50ZXN0UGFyZW50ID0gb3B0aW9ucy5wYXJlbnQgfHwgbnVsbDtcbiAgICAgIHRoaXMudGVzdEZpcnN0Q2hpbGQgPSBvcHRpb25zLmZpcnN0Q2hpbGQgfHwgbnVsbDtcbiAgICAgIHRoaXMudGVzdENoaWxkcmVuID0gb3B0aW9ucy5jaGlsZHJlbiB8fCBudWxsO1xuICAgIH1cblxuICAgIHRoaXMucGFyYW1zID0gdGhpcy5wYXJhbXNTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMucXVlcnlQYXJhbXMgPSB0aGlzLnF1ZXJ5UGFyYW1zU3ViamVjdC5hc09ic2VydmFibGUoKTtcbiAgICB0aGlzLmRhdGEgPSB0aGlzLmRhdGFTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xuICAgIHRoaXMuZnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50U3ViamVjdC5hc09ic2VydmFibGUoKSBhcyBPYnNlcnZhYmxlPHN0cmluZz47XG4gICAgdGhpcy51cmwgPSB0aGlzLnVybFN1YmplY3QuYXNPYnNlcnZhYmxlKCkgYXMgT2JzZXJ2YWJsZTxVcmxTZWdtZW50W10+O1xuXG4gICAgdGhpcy5zbmFwc2hvdCA9IHRoaXMuYnVpbGRTbmFwc2hvdCgpO1xuXG4gICAgdGhpcy50cmlnZ2VyTmF2aWdhdGlvbigpO1xuICB9XG5cbiAgcHVibGljIGdldCBwYXJhbU1hcCgpOiBPYnNlcnZhYmxlPFBhcmFtTWFwPiB7XG4gICAgcmV0dXJuIHRoaXMucGFyYW1zU3ViamVjdC5hc09ic2VydmFibGUoKS5waXBlKG1hcChwYXJhbXMgPT4gY29udmVydFRvUGFyYW1NYXAocGFyYW1zKSkpO1xuICB9XG5cbiAgcHVibGljIHNuYXBzaG90OiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90O1xuXG4gIHB1YmxpYyBzZXRQYXJhbXMocGFyYW1zOiBQYXJhbXMpOiB2b2lkIHtcbiAgICB0aGlzLnRlc3RQYXJhbXMgPSBwYXJhbXM7XG4gICAgdGhpcy5zbmFwc2hvdCA9IHRoaXMuYnVpbGRTbmFwc2hvdCgpO1xuICB9XG5cbiAgcHVibGljIHNldFBhcmFtKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMudGVzdFBhcmFtcyA9IHsgLi4udGhpcy50ZXN0UGFyYW1zLCBbbmFtZV06IHZhbHVlIH07XG4gICAgdGhpcy5zbmFwc2hvdCA9IHRoaXMuYnVpbGRTbmFwc2hvdCgpO1xuICB9XG5cbiAgcHVibGljIHNldFF1ZXJ5UGFyYW1zKHF1ZXJ5UGFyYW1zOiBQYXJhbXMpOiB2b2lkIHtcbiAgICB0aGlzLnRlc3RRdWVyeVBhcmFtcyA9IHF1ZXJ5UGFyYW1zO1xuICAgIHRoaXMuc25hcHNob3QgPSB0aGlzLmJ1aWxkU25hcHNob3QoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRRdWVyeVBhcmFtKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMudGVzdFF1ZXJ5UGFyYW1zID0geyAuLi50aGlzLnRlc3RRdWVyeVBhcmFtcywgW25hbWVdOiB2YWx1ZSB9O1xuICAgIHRoaXMuc25hcHNob3QgPSB0aGlzLmJ1aWxkU25hcHNob3QoKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRBbGxEYXRhKGRhdGE6IERhdGEpOiB2b2lkIHtcbiAgICB0aGlzLnRlc3REYXRhID0gZGF0YTtcbiAgICB0aGlzLnNuYXBzaG90ID0gdGhpcy5idWlsZFNuYXBzaG90KCk7XG4gIH1cblxuICBwdWJsaWMgc2V0RGF0YShuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnRlc3REYXRhID0geyAuLi50aGlzLnRlc3REYXRhLCBbbmFtZV06IHZhbHVlIH07XG4gICAgdGhpcy5zbmFwc2hvdCA9IHRoaXMuYnVpbGRTbmFwc2hvdCgpO1xuICB9XG5cbiAgcHVibGljIHNldEZyYWdtZW50KGZyYWdtZW50OiBzdHJpbmcgfCBudWxsKTogdm9pZCB7XG4gICAgdGhpcy50ZXN0RnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICB0aGlzLnNuYXBzaG90ID0gdGhpcy5idWlsZFNuYXBzaG90KCk7XG4gIH1cblxuICBwdWJsaWMgc2V0VXJsKHVybDogVXJsU2VnbWVudFtdKTogdm9pZCB7XG4gICAgdGhpcy50ZXN0VXJsID0gdXJsO1xuICAgIHRoaXMuc25hcHNob3QgPSB0aGlzLmJ1aWxkU25hcHNob3QoKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgcm9vdCgpOiBBY3RpdmF0ZWRSb3V0ZVN0dWIge1xuICAgIHJldHVybiB0aGlzLnRlc3RSb290IHx8IHRoaXM7XG4gIH1cblxuICBwdWJsaWMgZ2V0IHBhcmVudCgpOiBBY3RpdmF0ZWRSb3V0ZVN0dWIgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy50ZXN0UGFyZW50IHx8IG51bGw7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGNoaWxkcmVuKCk6IEFjdGl2YXRlZFJvdXRlU3R1YltdIHtcbiAgICByZXR1cm4gdGhpcy50ZXN0Q2hpbGRyZW4gfHwgW3RoaXNdO1xuICB9XG5cbiAgcHVibGljIGdldCBmaXJzdENoaWxkKCk6IEFjdGl2YXRlZFJvdXRlU3R1YiB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnRlc3RGaXJzdENoaWxkIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogU2ltdWxhdGVzIGEgcm91dGUgbmF2aWdhdGlvbiBieSB1cGRhdGluZyB0aGUgUGFyYW1zLCBRdWVyeVBhcmFtcyBhbmQgRGF0YSBvYnNlcnZhYmxlIHN0cmVhbXMuXG4gICAqL1xuICBwdWJsaWMgdHJpZ2dlck5hdmlnYXRpb24oKTogdm9pZCB7XG4gICAgdGhpcy5wYXJhbXNTdWJqZWN0Lm5leHQodGhpcy50ZXN0UGFyYW1zKTtcbiAgICB0aGlzLnF1ZXJ5UGFyYW1zU3ViamVjdC5uZXh0KHRoaXMudGVzdFF1ZXJ5UGFyYW1zKTtcbiAgICB0aGlzLmRhdGFTdWJqZWN0Lm5leHQodGhpcy50ZXN0RGF0YSk7XG4gICAgdGhpcy5mcmFnbWVudFN1YmplY3QubmV4dCh0aGlzLnRlc3RGcmFnbWVudCk7XG4gICAgdGhpcy51cmxTdWJqZWN0Lm5leHQodGhpcy50ZXN0VXJsKTtcbiAgfVxuXG4gIHB1YmxpYyB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiAnYWN0aXZhdGVkUm91dGVTdHViJztcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRTbmFwc2hvdCgpOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90IHtcbiAgICBjb25zdCBzbmFwc2hvdCA9IG5ldyBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90KCk7XG5cbiAgICBzbmFwc2hvdC5wYXJhbXMgPSB0aGlzLnRlc3RQYXJhbXM7XG4gICAgc25hcHNob3QucXVlcnlQYXJhbXMgPSB0aGlzLnRlc3RRdWVyeVBhcmFtcztcbiAgICBzbmFwc2hvdC5kYXRhID0gdGhpcy50ZXN0RGF0YTtcbiAgICBzbmFwc2hvdC5mcmFnbWVudCA9IHRoaXMudGVzdEZyYWdtZW50ITtcbiAgICBzbmFwc2hvdC51cmwgPSB0aGlzLnRlc3RVcmw7XG5cbiAgICByZXR1cm4gc25hcHNob3Q7XG4gIH1cbn1cbiJdfQ==