import { Spectator } from '../spectator/spectator';
import { isRouterStub } from './router-stub';
/**
 * @publicApi
 */
export class SpectatorRouting extends Spectator {
    constructor(fixture, debugElement, instance, router, activatedRouteStub) {
        super(fixture, debugElement, instance, debugElement.nativeElement);
        this.router = router;
        this.activatedRouteStub = activatedRouteStub;
    }
    /**
     * Simulates a route navigation by updating the Params, QueryParams and Data observable streams.
     */
    triggerNavigation(options) {
        if (!this.checkStubPresent()) {
            return;
        }
        if (options && options.params) {
            this.activatedRouteStub.setParams(options.params);
        }
        if (options && options.queryParams) {
            this.activatedRouteStub.setQueryParams(options.queryParams);
        }
        if (options && options.data) {
            this.activatedRouteStub.setAllData(options.data);
        }
        if (options && options.fragment) {
            this.activatedRouteStub.setFragment(options.fragment);
        }
        this.triggerNavigationAndUpdate();
    }
    /**
     * Updates the route params and triggers a route navigation.
     */
    setRouteParam(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setParam(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route query params and triggers a route navigation.
     */
    setRouteQueryParam(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setQueryParam(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route data and triggers a route navigation.
     */
    setRouteData(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setData(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route fragment and triggers a route navigation.
     */
    setRouteFragment(fragment) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setFragment(fragment);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route url and triggers a route navigation.
     */
    setRouteUrl(url) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setUrl(url);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Emits a router event
     */
    emitRouterEvent(event) {
        if (!isRouterStub(this.router)) {
            // tslint:disable-next-line:no-console
            console.warn('No stub for Router present. Set Spectator option "stubsEnabled" to true if you want to use this ' +
                'helper, or use Router navigation to trigger events.');
            return;
        }
        this.router.emitRouterEvent(event);
    }
    triggerNavigationAndUpdate() {
        this.activatedRouteStub.triggerNavigation();
        this.detectChanges();
    }
    checkStubPresent() {
        if (!this.activatedRouteStub) {
            // tslint:disable-next-line:no-console
            console.warn('No stub for ActivatedRoute present. Set Spectator option "stubsEnabled" to true if you want to use this ' +
                'helper, or use Router to trigger navigation.');
            return false;
        }
        return true;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BlY3RhdG9yLXJvdXRpbmcuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL25ldGFuZWxiYXNhbC93d3cvc3BlY3RhdG9yL3Byb2plY3RzL3NwZWN0YXRvci9zcmMvIiwic291cmNlcyI6WyJsaWIvc3BlY3RhdG9yLXJvdXRpbmcvc3BlY3RhdG9yLXJvdXRpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBSW5ELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFN0M7O0dBRUc7QUFDSCxNQUFNLE9BQU8sZ0JBQW9CLFNBQVEsU0FBWTtJQUNuRCxZQUNFLE9BQThCLEVBQzlCLFlBQTBCLEVBQzFCLFFBQVcsRUFDSyxNQUFjLEVBQ2Qsa0JBQXVDO1FBRXZELEtBQUssQ0FBQyxPQUFPLEVBQUUsWUFBWSxFQUFFLFFBQVEsRUFBRSxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUM7UUFIbkQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBcUI7SUFHekQsQ0FBQztJQUVEOztPQUVHO0lBQ0ksaUJBQWlCLENBQUMsT0FBc0I7UUFDN0MsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFO1lBQzVCLE9BQU87U0FDUjtRQUVELElBQUksT0FBTyxJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7WUFDN0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDbkQ7UUFFRCxJQUFJLE9BQU8sSUFBSSxPQUFPLENBQUMsV0FBVyxFQUFFO1lBQ2xDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1NBQzdEO1FBRUQsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLElBQUksRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNsRDtRQUVELElBQUksT0FBTyxJQUFJLE9BQU8sQ0FBQyxRQUFRLEVBQUU7WUFDL0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDdkQ7UUFFRCxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztJQUNwQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxhQUFhLENBQUMsSUFBWSxFQUFFLEtBQWE7UUFDOUMsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM5QyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztTQUNuQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLGtCQUFrQixDQUFDLElBQVksRUFBRSxLQUFhO1FBQ25ELElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDbkQsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsSUFBWSxFQUFFLEtBQWE7UUFDN0MsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM3QyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztTQUNuQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLGdCQUFnQixDQUFDLFFBQXVCO1FBQzdDLElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM5QyxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztTQUNuQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxHQUFpQjtRQUNsQyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDcEMsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxlQUFlLENBQUMsS0FBWTtRQUNqQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUM5QixzQ0FBc0M7WUFDdEMsT0FBTyxDQUFDLElBQUksQ0FDVixrR0FBa0c7Z0JBQ2hHLHFEQUFxRCxDQUN4RCxDQUFDO1lBRUYsT0FBTztTQUNSO1FBRUQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVPLDBCQUEwQjtRQUNoQyxJQUFJLENBQUMsa0JBQW1CLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUM3QyxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUVPLGdCQUFnQjtRQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixFQUFFO1lBQzVCLHNDQUFzQztZQUN0QyxPQUFPLENBQUMsSUFBSSxDQUNWLDBHQUEwRztnQkFDeEcsOENBQThDLENBQ2pELENBQUM7WUFFRixPQUFPLEtBQUssQ0FBQztTQUNkO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZWJ1Z0VsZW1lbnQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbXBvbmVudEZpeHR1cmUgfSBmcm9tICdAYW5ndWxhci9jb3JlL3Rlc3RpbmcnO1xuaW1wb3J0IHsgRXZlbnQsIFJvdXRlciwgVXJsU2VnbWVudCB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5cbmltcG9ydCB7IFNwZWN0YXRvciB9IGZyb20gJy4uL3NwZWN0YXRvci9zcGVjdGF0b3InO1xuXG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZVN0dWIgfSBmcm9tICcuL2FjdGl2YXRlZC1yb3V0ZS1zdHViJztcbmltcG9ydCB7IFJvdXRlT3B0aW9ucyB9IGZyb20gJy4vcm91dGUtb3B0aW9ucyc7XG5pbXBvcnQgeyBpc1JvdXRlclN0dWIgfSBmcm9tICcuL3JvdXRlci1zdHViJztcblxuLyoqXG4gKiBAcHVibGljQXBpXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVjdGF0b3JSb3V0aW5nPEM+IGV4dGVuZHMgU3BlY3RhdG9yPEM+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgZml4dHVyZTogQ29tcG9uZW50Rml4dHVyZTxhbnk+LFxuICAgIGRlYnVnRWxlbWVudDogRGVidWdFbGVtZW50LFxuICAgIGluc3RhbmNlOiBDLFxuICAgIHB1YmxpYyByZWFkb25seSByb3V0ZXI6IFJvdXRlcixcbiAgICBwdWJsaWMgcmVhZG9ubHkgYWN0aXZhdGVkUm91dGVTdHViPzogQWN0aXZhdGVkUm91dGVTdHViXG4gICkge1xuICAgIHN1cGVyKGZpeHR1cmUsIGRlYnVnRWxlbWVudCwgaW5zdGFuY2UsIGRlYnVnRWxlbWVudC5uYXRpdmVFbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTaW11bGF0ZXMgYSByb3V0ZSBuYXZpZ2F0aW9uIGJ5IHVwZGF0aW5nIHRoZSBQYXJhbXMsIFF1ZXJ5UGFyYW1zIGFuZCBEYXRhIG9ic2VydmFibGUgc3RyZWFtcy5cbiAgICovXG4gIHB1YmxpYyB0cmlnZ2VyTmF2aWdhdGlvbihvcHRpb25zPzogUm91dGVPcHRpb25zKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMucGFyYW1zKSB7XG4gICAgICB0aGlzLmFjdGl2YXRlZFJvdXRlU3R1Yi5zZXRQYXJhbXMob3B0aW9ucy5wYXJhbXMpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMucXVlcnlQYXJhbXMpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldFF1ZXJ5UGFyYW1zKG9wdGlvbnMucXVlcnlQYXJhbXMpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuZGF0YSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0QWxsRGF0YShvcHRpb25zLmRhdGEpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuZnJhZ21lbnQpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldEZyYWdtZW50KG9wdGlvbnMuZnJhZ21lbnQpO1xuICAgIH1cblxuICAgIHRoaXMudHJpZ2dlck5hdmlnYXRpb25BbmRVcGRhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSByb3V0ZSBwYXJhbXMgYW5kIHRyaWdnZXJzIGEgcm91dGUgbmF2aWdhdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzZXRSb3V0ZVBhcmFtKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0UGFyYW0obmFtZSwgdmFsdWUpO1xuICAgICAgdGhpcy50cmlnZ2VyTmF2aWdhdGlvbkFuZFVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSByb3V0ZSBxdWVyeSBwYXJhbXMgYW5kIHRyaWdnZXJzIGEgcm91dGUgbmF2aWdhdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzZXRSb3V0ZVF1ZXJ5UGFyYW0obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2hlY2tTdHViUHJlc2VudCgpKSB7XG4gICAgICB0aGlzLmFjdGl2YXRlZFJvdXRlU3R1Yi5zZXRRdWVyeVBhcmFtKG5hbWUsIHZhbHVlKTtcbiAgICAgIHRoaXMudHJpZ2dlck5hdmlnYXRpb25BbmRVcGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgcm91dGUgZGF0YSBhbmQgdHJpZ2dlcnMgYSByb3V0ZSBuYXZpZ2F0aW9uLlxuICAgKi9cbiAgcHVibGljIHNldFJvdXRlRGF0YShuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jaGVja1N0dWJQcmVzZW50KCkpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldERhdGEobmFtZSwgdmFsdWUpO1xuICAgICAgdGhpcy50cmlnZ2VyTmF2aWdhdGlvbkFuZFVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSByb3V0ZSBmcmFnbWVudCBhbmQgdHJpZ2dlcnMgYSByb3V0ZSBuYXZpZ2F0aW9uLlxuICAgKi9cbiAgcHVibGljIHNldFJvdXRlRnJhZ21lbnQoZnJhZ21lbnQ6IHN0cmluZyB8IG51bGwpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jaGVja1N0dWJQcmVzZW50KCkpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldEZyYWdtZW50KGZyYWdtZW50KTtcbiAgICAgIHRoaXMudHJpZ2dlck5hdmlnYXRpb25BbmRVcGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgcm91dGUgdXJsIGFuZCB0cmlnZ2VycyBhIHJvdXRlIG5hdmlnYXRpb24uXG4gICAqL1xuICBwdWJsaWMgc2V0Um91dGVVcmwodXJsOiBVcmxTZWdtZW50W10pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jaGVja1N0dWJQcmVzZW50KCkpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldFVybCh1cmwpO1xuICAgICAgdGhpcy50cmlnZ2VyTmF2aWdhdGlvbkFuZFVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhIHJvdXRlciBldmVudFxuICAgKi9cbiAgcHVibGljIGVtaXRSb3V0ZXJFdmVudChldmVudDogRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoIWlzUm91dGVyU3R1Yih0aGlzLnJvdXRlcikpIHtcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdObyBzdHViIGZvciBSb3V0ZXIgcHJlc2VudC4gU2V0IFNwZWN0YXRvciBvcHRpb24gXCJzdHVic0VuYWJsZWRcIiB0byB0cnVlIGlmIHlvdSB3YW50IHRvIHVzZSB0aGlzICcgK1xuICAgICAgICAgICdoZWxwZXIsIG9yIHVzZSBSb3V0ZXIgbmF2aWdhdGlvbiB0byB0cmlnZ2VyIGV2ZW50cy4nXG4gICAgICApO1xuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5yb3V0ZXIuZW1pdFJvdXRlckV2ZW50KGV2ZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgdHJpZ2dlck5hdmlnYXRpb25BbmRVcGRhdGUoKTogdm9pZCB7XG4gICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIhLnRyaWdnZXJOYXZpZ2F0aW9uKCk7XG4gICAgdGhpcy5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBwcml2YXRlIGNoZWNrU3R1YlByZXNlbnQoKTogdGhpcyBpcyB7IHJlYWRvbmx5IGFjdGl2YXRlZFJvdXRlU3R1YjogQWN0aXZhdGVkUm91dGVTdHViIH0ge1xuICAgIGlmICghdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIpIHtcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdObyBzdHViIGZvciBBY3RpdmF0ZWRSb3V0ZSBwcmVzZW50LiBTZXQgU3BlY3RhdG9yIG9wdGlvbiBcInN0dWJzRW5hYmxlZFwiIHRvIHRydWUgaWYgeW91IHdhbnQgdG8gdXNlIHRoaXMgJyArXG4gICAgICAgICAgJ2hlbHBlciwgb3IgdXNlIFJvdXRlciB0byB0cmlnZ2VyIG5hdmlnYXRpb24uJ1xuICAgICAgKTtcblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG4iXX0=